<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/three.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multiplayer Threejs</title>
    <style>
      body {
        margin: 0;
        overflow: hidden; /* Prevent scrolling when tilting */
      }
      #app {
        width: 100vw;
        height: 100vh;
        position: relative;
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script type="module">
      // Define key states for motion
      const keyStates = {
        w: false,
        a: false,
        s: false,
        d: false,
      };

      // Sensitivity thresholds for orientation changes
      const tiltThreshold = 10; // Degrees

      // Function to set key states
      function setKeyState(key, value) {
        if (keyStates[key] !== value) {
          keyStates[key] = value;
          console.log(`${key} is now ${value ? 'pressed' : 'released'}`);
          handleKeyStates(); // Trigger motion updates
        }
      }

      // Orientation event handler
      function handleOrientation(event) {
        const { beta, gamma } = event; // beta: front-back tilt, gamma: left-right tilt

        // Forward and backward tilt (beta)
        if (beta > tiltThreshold) {
          setKeyState('w', true); // Tilt forward
          setKeyState('s', false);
        } else if (beta < -tiltThreshold) {
          setKeyState('s', true); // Tilt backward
          setKeyState('w', false);
        } else {
          setKeyState('w', false);
          setKeyState('s', false);
        }

        // Left and right tilt (gamma)
        if (gamma > tiltThreshold) {
          setKeyState('d', true); // Tilt right
          setKeyState('a', false);
        } else if (gamma < -tiltThreshold) {
          setKeyState('a', true); // Tilt left
          setKeyState('d', false);
        } else {
          setKeyState('a', false);
          setKeyState('d', false);
        }
      }

      // Attach orientation event listener
      if (window.DeviceOrientationEvent) {
        window.addEventListener('deviceorientation', handleOrientation);
      } else {
        console.error('DeviceOrientation is not supported on this device.');
      }

      // WASD logic (example implementation; replace with your existing function)
      function handleKeyStates() {
        // Example WASD handling logic
        if (keyStates['w']) console.log('Move Forward');
        if (keyStates['a']) console.log('Move Left');
        if (keyStates['s']) console.log('Move Backward');
        if (keyStates['d']) console.log('Move Right');
      }
    </script>
    <script type="module" src="/src/app.js"></script>
  </body>
</html>
